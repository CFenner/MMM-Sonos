<style>
.iso-marquee {
  max-width: {{ maxTextLength }}em;
}
</style>

<div class="sonos">
  {% if loaded %}
    <ul class={{ "flip" if flip else "" }}>
      {% for room in roomList %}
        {% if room.state == 'PLAYING' or showStoppedRoom %}
          <li>
            <div>
             {% if showAlbumArtLeft %}
                <div class="art">
                  <img src="{{ room.albumArt }}"/>
                </div>
              {% endif %}
              {% if scrollSpeed > 0 and room.artist.length > maxTextLength and room.track.length > maxTextLength %}
                {% if room.artist.length > room.track.length %}
                  <div class="name normal medium iso-marquee" style="--tw:{{ room.artist.length * 1.1 }}ch; --ad:{{scrollSpeed}}s;">
                {% else %}
                   <div class="name normal medium iso-marquee" style="--tw:{{ room.track.length * 1.1 }}ch; --ad:{{scrollSpeed}}s;">
                {% endif %}
              {% else %}
                <div class="name normal medium">
              {% endif %}
                <div>{{ room.artist }}</div>
                <div>{{ room.track }}</div>
              </div>
              {% if showAlbumArtRight %}
                <div class="art">
                  <img src="{{ room.albumArt }}"/>
                </div>
              {% endif %}
            </div>
            {% if showRoomName %}
              <div class="room xsmall">
                {{ room.name }}
              </div>
            {% endif %}
          </li>
        {% endif %}
      {% endfor %}
    </ul>
  {% else %}
    <div class="dimmed light small">
      {{ labelLoading|safe }}
    </div>
  {% endif %}
</div>
